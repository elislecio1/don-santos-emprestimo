#!/usr/bin/env python3
"""
Script para processar a planilha de fatores INSS e gerar CSV para importação
"""

import pandas as pd
import csv

# Dados extraídos da planilha
# Prazos: 18, 24, 30, 36, 48, 60, 72
prazos = [18, 24, 30, 36, 48, 60, 72]

# Fatores por dia (1-31) para cada prazo
fatores_data = [
    # Dia, 18, 24, 30, 36, 48, 60, 72
    [1, 0.06816, 0.0542, 0.04586, 0.04036, 0.0336, 0.02969, 0.0272],
    [2, 0.06811, 0.05416, 0.04583, 0.04033, 0.03358, 0.02967, 0.02718],
    [3, 0.06936, 0.05517, 0.04669, 0.04109, 0.03422, 0.03023, 0.0277],
    [4, 0.06932, 0.05513, 0.04666, 0.04107, 0.0342, 0.03021, 0.02768],
    [5, 0.06927, 0.0551, 0.04663, 0.04104, 0.03417, 0.03019, 0.02766],
    [6, 0.06923, 0.05506, 0.0466, 0.04101, 0.03415, 0.03017, 0.02764],
    [7, 0.06919, 0.05503, 0.04657, 0.04099, 0.03413, 0.03015, 0.02763],
    [8, 0.06914, 0.05499, 0.04654, 0.04096, 0.03411, 0.03013, 0.02761],
    [9, 0.0691, 0.05496, 0.04651, 0.04093, 0.03408, 0.03011, 0.02759],
    [10, 0.06906, 0.05492, 0.04648, 0.04091, 0.03406, 0.0301, 0.02757],
    [11, 0.06901, 0.05489, 0.04645, 0.04088, 0.03404, 0.03008, 0.02755],
    [12, 0.06897, 0.05486, 0.04642, 0.04085, 0.03402, 0.03006, 0.02754],
    [13, 0.06893, 0.05482, 0.04639, 0.04083, 0.034, 0.03004, 0.02752],
    [14, 0.06888, 0.05479, 0.04636, 0.0408, 0.03397, 0.03002, 0.0275],
    [15, 0.06884, 0.05475, 0.04633, 0.04078, 0.03395, 0.03, 0.02748],
    [16, 0.0688, 0.05472, 0.0463, 0.04075, 0.03393, 0.02998, 0.02746],
    [17, 0.06876, 0.05468, 0.04627, 0.04072, 0.03391, 0.02996, 0.02745],
    [18, 0.06871, 0.05465, 0.04624, 0.0407, 0.03389, 0.02994, 0.02743],
    [19, 0.06867, 0.05461, 0.04621, 0.04067, 0.03386, 0.02992, 0.02741],
    [20, 0.06863, 0.05458, 0.04618, 0.04064, 0.03384, 0.0299, 0.02739],
    [21, 0.06858, 0.05454, 0.04615, 0.04062, 0.03382, 0.02988, 0.02737],
    [22, 0.06854, 0.05451, 0.04612, 0.04059, 0.0338, 0.02986, 0.02736],
    [23, 0.0685, 0.05447, 0.04609, 0.04057, 0.03378, 0.02984, 0.02734],
    [24, 0.06845, 0.05444, 0.04606, 0.04054, 0.03375, 0.02982, 0.02732],
    [25, 0.06841, 0.0544, 0.04603, 0.04051, 0.03373, 0.0298, 0.0273],
    [26, 0.06837, 0.05437, 0.046, 0.04049, 0.03371, 0.02978, 0.02729],
    [27, 0.06833, 0.05433, 0.04597, 0.04046, 0.03369, 0.02976, 0.02727],
    [28, 0.06828, 0.0543, 0.04594, 0.04043, 0.03367, 0.02974, 0.02725],
    [29, 0.06824, 0.05427, 0.04592, 0.04041, 0.03364, 0.02972, 0.02723],
    [30, 0.0682, 0.05423, 0.04589, 0.04038, 0.03362, 0.02971, 0.02721],
    [31, 0.0682, 0.05423, 0.04589, 0.04038, 0.03362, 0.02971, 0.02721],
]

# Gerar CSV no formato prazo,dia,fator
output_file = '/home/ubuntu/don-santos-emprestimo/data/fatores_inss.csv'

with open(output_file, 'w', newline='') as f:
    writer = csv.writer(f)
    writer.writerow(['prazo', 'dia', 'fator'])
    
    for row in fatores_data:
        dia = row[0]
        for i, prazo in enumerate(prazos):
            fator = row[i + 1]
            writer.writerow([prazo, dia, fator])

print(f"CSV gerado com sucesso: {output_file}")
print(f"Total de registros: {len(fatores_data) * len(prazos)}")
